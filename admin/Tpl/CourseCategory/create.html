<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Administration Center</title>
<link media="all" rel="stylesheet" href="/style/bootstrap.min.css" type="text/css" />
<link media="all" rel="stylesheet" href="/style/admin.css" type="text/css" />
</head>
<body>

<include file="Public:navbar" />

<div class="sidebar-nav">
  <div class="well">
    <ul class="nav nav-list">
      <li><a href="__APP__/"><i class="icon-home"></i> 首页</a></li>
      <li><div class="divider"></div></li>
      <li class="nav-header">标准栏目</li>
      <li><a href="__APP__/common_column"><i class="icon-th-large"></i> 栏目管理</a></li>
      <li><a href="__APP__/common_article"><i class="icon-th-list"></i> 文章管理</a></li>
      <li><div class="divider"></div></li>
      <li class="nav-header">在线教程</li>
      <li><a href="__APP__/course_slide"><i class="icon-retweet"></i> 封面幻灯</a></li>
      <li class="active"><a href="__APP__/course_category"><i class="icon-th-large"></i> 教程分类</a></li>
      <li><a href="__APP__/course_article"><i class="icon-th-list"></i> 文章管理</a></li>
      <li><div class="divider"></div></li>
      <li class="nav-header">RADIO</li>
      <li><a href="__APP__/radio_slide"><i class="icon-retweet"></i> 封面幻灯</a></li>
      <li><a href="__APP__/radio_article"><i class="icon-th-list"></i> 文章管理</a></li>
      <li><div class="divider"></div></li>
      <li><a href="__APP__/user"><i class="icon-user"></i> 用户管理</a></li>
      <li><div class="divider"></div></li>
      <li><a href="__APP__/user/signout"><i class="icon-off"></i> 退出登录</a></li>
    </ul>
  </div>
</div><!--/.sidebar-nav-->

<div class="container-fluid content">
  <div class="row-fluid">
    <!-- Bread Crumb Navigation -->
    <div class="span12">
      <div>
        <ul class="breadcrumb">
          <li><a href="__APP__/">Administration Center</a> <span class="divider">/</span></li>
          <li>在线教程 <span class="divider">/</span></li>
          <li><a href="__APP__/course_category">教程分类</a> <span class="divider">/</span></li>
          <li class="active">新建</li>
        </ul>
      </div>

      <div class="row-fluid">
        <div class="span12">
          <ul class="nav nav-pills">
            <li><a href="__APP__/course_category">列表</a></li>
            <li class="active"><a href="__APP__/course_category/create">新建</a></li>
          </ul>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span12">
          <div class="box">
            <div class="box-container">
            <div class="box-content">
              <form class="form form-horizontal" method="post" action="">
                <div class="control-group">
                  <label for="name" class="control-label"><span class="star">*</span> 分类名称：</label>
                  <div class="controls">
                    <input type="text" class="input-xlarge" id="name" name="name" />
                  </div>
                </div>
                <div class="control-group">
                  <label for="picture" class="control-label">图片：</label>
                  <div class="controls">
                    <input type="file" class="input-file" id="picture_upload" name="picture_upload" />
                    <input type="hidden" id="picture" name="picture" />
                    <div id="picture_wrapper"></div>
                  </div>
                </div>
                <div class="control-group">
                  <label for="sortorder" class="control-label">排序：</label>
                  <div class="controls">
                    <input type="text" class="input-mini" id="sortorder" name="sortorder" />
                    <span class="help-inline">从大到小排列</span>
                  </div>
                </div>
                <div class="form-actions">
                  <input class="btn btn-primary" type="submit" name="submit" value=" 保存 " />
                </div>
              </form>
            </div>
          </div>
            </div>
        </div>
      </div><!--/.row-fluid-->

    </div><!--/span12-->
  </div><!--/row-fluid-->
</div><!--/.container-fluid-->

<include file="Public:footer" />
<script src="/js/jquery.validate.min.js" type="text/javascript"></script>
<script src="/js/uploadify/swfobject.js" type="text/javascript"></script>
<script src="/js/uploadify/jquery.uploadify.js" type="text/javascript"></script>
<script type="text/javascript">
$(function() {
    $('.form').validate({
        rules: {
            name: 'required'
        },
        messages: {
            name: '请输入分类名称'
        }
    });

    $('#picture_upload').uploadify({
        'uploader'  : '/js/uploadify/uploadify.swf',
        'script'    : '__APP__/course_category/picture_upload?PHPSESSIONID=<?php echo session_id(); ?>',
        'scriptData' : { 'auth' : '<?php echo Cookie::get('auth'); ?>' },
        'cancelImg' : '/js/uploadify/cancel.png',
        'folder'    : '/uploads/images/',
        'fileExt'   : '*.gif;*.bmp;*.jpg;*.jpeg;*.png',
        'fileDesc'  : '图片文件',
        'auto'      : true,
        'buttonText' : '选择图片',
        'onComplete' : function(event, ID, fileObj, response, data) {
            var response = $.parseJSON(response);

            if (response.status == 0) {
                $('#picture_upload').uploadifyCancel();
            } else {
                $('#picture_wrapper').html('');
                $('#picture_wrapper').append('<img src="' + response.data.picture + '" />');
                // 上传新图成功后删除老图
                $.post('__APP__/course_category/picture_remove', { picture: $('#picture').val()});
                $('#picture').val(response.data.picture);
            }
        }
    });
});
</script>

</body>
</html>
